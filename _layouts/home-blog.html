---
layout: default
# home-blog.html
# - Chirpy의 home 레이아웃을 /blog 전용으로 커스터마이즈한 버전
# - 업데이트 요약:
#   (1) 상단 타이틀: 루트(/)는 "Home", 그 외 경로는 page.title 사용
#   (2) 카드 목록 데이터 소스: paginator.posts(존재 시) → 없으면 site.posts로 폴백
#   (3) pinned 글은 1페이지에서만 노출, hidden:true는 제외
refactor: true
---
{% include lang.html %}

<header class="d-flex align-items-center justify-content-between mt-3 mb-4">
  <h1 class="h2">
    {%- comment -%} (1) 타이틀 분기: 루트만 "Home", 그 외는 page.title {%- endcomment -%}
    {% assign default_home = site.data.locales[lang].tabs.home | default: 'Home' %}
    {% if page.url == '/' %}
      {{ default_home }}
    {% else %}
      {{ page.title | default: default_home }}
    {% endif %}
  </h1>
</header>

{%- comment -%} (2) 데이터 소스: v2 paginator → 폴백(site.posts), hidden:true는 제외 {%- endcomment -%}
{% assign coll = paginator.posts | default: site.posts %}
{% assign visible_posts = coll | where_exp: 'post', 'post.hidden != true' %}
{% assign pinned_posts = visible_posts | where: 'pin', true %}
{% assign normal_posts = visible_posts | where_exp: 'post', 'post.pin != true' %}

{%- comment -%} (3) pinned는 1페이지에서만 노출 {%- endcomment -%}
{% assign show_pinned = true %}
{% if paginator and paginator.page and paginator.page > 1 %}
  {% assign show_pinned = false %}
{% endif %}

<div id="post-list" class="flex-grow-1 px-xl-1">
  {%- if show_pinned and pinned_posts and pinned_posts.size > 0 -%}
    {%- for post in pinned_posts -%}
      <article class="card-wrapper card">
        <a href="{{ post.url | relative_url }}" class="post-preview row g-0 flex-md-row-reverse">
          {%- assign has_image = post.image -%}
          {%- assign card_body_col = '12' -%}
          {%- if has_image -%}
            {%- assign card_body_col = '7' -%}
          {%- endif -%}

          {%- if has_image -%}
            {%- assign src = post.image.path | default: post.image -%}
            {%- capture src -%}{% include media-url.html src=src subpath=post.media_subpath %}{%- endcapture -%}
            <div class="col-md-5">
              <img src="{{ src | strip }}" alt="{{ post.image.alt | default: 'Preview Image' }}">
            </div>
          {%- endif -%}

          <div class="col-md-{{ card_body_col }}">
            <div class="card-body d-flex flex-column">
              <h1 class="card-title my-2 mt-md-0">
                {{ post.title | escape }}
                <span class="badge text-bg-warning ms-2 align-middle">PIN</span>
              </h1>
              <div class="card-text content mt-0 mb-3">
                <p>{% include post-description.html %}</p>
              </div>
            </div>
          </div>
        </a>
      </article>
    {%- endfor -%}
  {%- endif -%}

  {%- for post in normal_posts -%}
    <article class="card-wrapper card">
      <a href="{{ post.url | relative_url }}" class="post-preview row g-0 flex-md-row-reverse">
        {%- assign has_image = post.image -%}
        {%- assign card_body_col = '12' -%}
        {%- if has_image -%}
          {%- assign card_body_col = '7' -%}
        {%- endif -%}

        {%- if has_image -%}
          {%- assign src = post.image.path | default: post.image -%}
          {%- capture src -%}{% include media-url.html src=src subpath=post.media_subpath %}{%- endcapture -%}
          <div class="col-md-5">
            <img src="{{ src | strip }}" alt="{{ post.image.alt | default: 'Preview Image' }}">
          </div>
        {%- endif -%}

        <div class="col-md-{{ card_body_col }}">
          <div class="card-body d-flex flex-column">
            <h1 class="card-title my-2 mt-md-0">{{ post.title | escape }}</h1>
            <div class="card-text content mt-0 mb-3">
              <p>{% include post-description.html %}</p>
            </div>
          </div>
        </div>
      </a>
    </article>
  {%- endfor -%}
</div>

{%- comment -%} 페이지네이터: v2 사용 시에만 노출 {%- endcomment -%}
{% if paginator and paginator.total_pages and paginator.total_pages > 1 %}
  {% include post-paginator.html %}
{% endif %}
